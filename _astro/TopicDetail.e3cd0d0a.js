import{p as S,h as c,_ as E,F as $}from"./hooks.module.9ee1d4a4.js";import{C as _}from"./close.3a539829.js";import{S as D}from"./spinner.164b1eeb.js";import{u as M,a as x}from"./use-outside-click.57ca3edf.js";import{a as A}from"./http.1ee0e3a2.js";import{i as R}from"./jwt.2bcbdb7f.js";import{g as G,u as U,r as H,i as z}from"./resource-progress.d33f2209.js";import{p as N,s as B}from"./page.d4f83d9f.js";import{o as e}from"./jsxRuntime.module.8b00cb04.js";import{k as F}from"./preact.module.f1575aff.js";function O(u){S(()=>{function t(i){const{resourceType:r,resourceId:o,topicId:p}=i.detail;u({resourceType:r,resourceId:o,topicId:p})}return window.addEventListener("roadmap.topic.click",t),window.addEventListener("best-practice.topic.click",t),()=>{window.removeEventListener("roadmap.topic.click",t),window.removeEventListener("best-practice.topic.click",t)}},[])}function K(u){S(()=>{function t(i){const{resourceType:r,resourceId:o,topicId:p}=i.detail;u({resourceType:r,resourceId:o,topicId:p})}return window.addEventListener("best-practice.topic.toggle",t),()=>{window.removeEventListener("best-practice.topic.toggle",t)}},[])}const J="/_astro/down.93d0ce97.svg",b={done:"bg-green-500",learning:"bg-yellow-500",pending:"bg-gray-300",skipped:"bg-black"};function Q(u){const{topicId:t,resourceId:i,resourceType:r,onClose:o,onShowLoginPopup:p}=u,[k,g]=c(!0),[n,h]=c("pending"),[v,y]=c(!1),f=E(null);M(f,()=>{y(!1)});const T=$(()=>!R(),[]);S(()=>{!t||!i||!r||(g(!0),G({topicId:t,resourceId:i,resourceType:r}).then(s=>{g(!1),h(s)}).catch(console.error))},[t,i,r]),x("d",()=>{if(n==="done"){o();return}l("done")},[n]),x("l",()=>{if(n==="learning"){o();return}l("learning")},[n]),x("s",()=>{if(n==="skipped"){o();return}l("skipped")},[n]),x("r",()=>{if(console.log(n),n==="pending"){o();return}l("pending")},[n]);const l=s=>{if(T){o(),p();return}g(!0),U({topicId:t,resourceId:i,resourceType:r},s).then(()=>{h(s),o(),H(t,s)}).catch(a=>{alert(a.message),console.error(a)}).finally(()=>{g(!1)})},I=["pending","learning","done"].includes(n),w=["skipped","pending","learning"].includes(n),P=["done","skipped","pending"].includes(n),L=["skipped","done","learning"].includes(n);return k?e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:D}),e("span",{className:"ml-2",children:"Updating Status.."})]}):e("div",{className:"relative inline-flex rounded-md border border-gray-300",children:[e("span",{className:"inline-flex cursor-default items-center  p-1 px-2 text-sm text-black",children:[e("span",{class:"flex h-2 w-2",children:e("span",{class:`relative inline-flex h-2 w-2 rounded-full ${b[n]}`})}),e("span",{className:"ml-2 capitalize",children:n==="learning"?"In Progress":n})]}),e("button",{className:"inline-flex cursor-pointer items-center rounded-br-md rounded-tr-md border-l border-l-gray-300 bg-gray-100 p-1 px-2 text-sm text-black hover:bg-gray-200",onClick:()=>y(!0),children:[e("span",{className:"mr-0.5",children:"Update Status"}),e("img",{alt:"Check",class:"h-4 w-4",src:J})]}),v&&e("div",{className:"absolute right-0 top-full mt-1 flex min-w-[160px] flex-col divide-y rounded-md border border-gray-200 bg-white shadow-md [&>button:first-child]:rounded-t-md [&>button:last-child]:rounded-b-md",ref:f,children:[w&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("done"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.done}`}),"Done"]}),e("span",{class:"text-xs text-gray-500",children:"D"})]}),P&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("learning"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.learning}`}),"In Progress"]}),e("span",{class:"text-xs text-gray-500",children:"L"})]}),L&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("pending"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.pending}`}),"Reset"]}),e("span",{class:"text-xs text-gray-500",children:"R"})]}),I&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("skipped"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.skipped}`}),"Skip"]}),e("span",{class:"text-xs text-gray-500",children:"S"})]})]})]})}function ie(){const[u,t]=c(!1),[i,r]=c(!1),[o,p]=c(""),[k,g]=c(""),n=$(()=>!R(),[]),h=E(null),[v,y]=c(""),[f,T]=c(""),[l,I]=c("roadmap"),w=()=>{const s=document.querySelector("#login-popup");if(!s)return;s.classList.remove("hidden"),s.classList.add("flex");const a=s.querySelector("[autofocus]");a&&a.focus()};if(M(h,()=>{t(!1)}),x("Escape",()=>{t(!1)}),K(({topicId:s,resourceType:a,resourceId:m})=>{if(n){w();return}N.set("Updating"),z({topicId:s,resourceId:m,resourceType:a}).then(d=>U({topicId:s,resourceId:m,resourceType:a},d?"pending":"done")).then(({done:d=[]})=>{H(s,d.includes(s)?"done":"pending")}).catch(d=>{alert(d.message),console.error(d)}).finally(()=>{N.set("")})}),O(({topicId:s,resourceType:a,resourceId:m})=>{r(!0),t(!0),B.set(!0),y(s),I(a),T(m);const d=s.replaceAll(":","/"),q=a==="roadmap"?`/${m}/${d}`:`/best-practices/${m}/${d}`;A(q,{},{headers:{Accept:"text/html"}}).then(({response:C})=>{if(!C){p("Topic not found.");return}const j=new DOMParser().parseFromString(C,"text/html")?.getElementById("main-content")?.outerHTML||"";r(!1),g(j)}).catch(C=>{p("Something went wrong. Please try again later."),r(!1)})}),!u)return null;const L=`https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/${l==="roadmap"?"roadmaps":"best-practices"}/${f}/content`;return e("div",{children:[e("div",{ref:h,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[i&&e("div",{className:"flex w-full justify-center",children:e("img",{src:D,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!i&&!o&&e(F,{children:[e("div",{className:"mb-2",children:[e(Q,{topicId:v,resourceId:f,resourceType:l,onShowLoginPopup:w,onClose:()=>{t(!1)}}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>t(!1),children:e("img",{alt:"Close",class:"h-5 w-5",src:_})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:k}}),e("p",{id:"contrib-meta",class:"mt-10 border-t pt-3 text-sm leading-relaxed text-gray-400",children:["Contribute links to learning resources about this topic"," ",e("a",{target:"_blank",class:"text-blue-700 underline",href:L,children:"on GitHub repository."}),"."]})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}export{ie as TopicDetail};
