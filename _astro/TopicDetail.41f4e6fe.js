import{p as S,h as l,_ as D,F as $}from"./hooks.module.a845df0c.js";import{C as B}from"./close.3a539829.js";import{S as A}from"./spinner.164b1eeb.js";import{u as M,a as N}from"./use-outside-click.bd11f1f3.js";import{h as G,a as _}from"./http.1ee0e3a2.js";import{i as q}from"./jwt.2bcbdb7f.js";import{g as z,u as H,r as U,i as O}from"./resource-progress.d33f2209.js";import{p as E,s as K}from"./page.20ef1caf.js";import{o as e}from"./jsxRuntime.module.8b00cb04.js";import{k as Q}from"./preact.module.f1575aff.js";function W(m){S(()=>{function n(a){const{resourceType:s,resourceId:o,topicId:u}=a.detail;m({resourceType:s,resourceId:o,topicId:u})}return window.addEventListener("roadmap.topic.click",n),window.addEventListener("best-practice.topic.click",n),()=>{window.removeEventListener("roadmap.topic.click",n),window.removeEventListener("best-practice.topic.click",n)}},[])}function J(m){S(()=>{function n(a){const{resourceType:s,resourceId:o,topicId:u}=a.detail;m({resourceType:s,resourceId:o,topicId:u})}return window.addEventListener("best-practice.topic.toggle",n),()=>{window.removeEventListener("best-practice.topic.toggle",n)}},[])}const V="/_astro/down.93d0ce97.svg",L={done:"bg-green-500",learning:"bg-yellow-500",pending:"bg-gray-300",skipped:"bg-black"};function X(m){const{topicId:n,resourceId:a,resourceType:s,onClose:o,onShowLoginPopup:u}=m,[b,r]=l(!0),[t,h]=l("pending"),[i,g]=l(!1),c=D(null);M(c,()=>{g(!1)});const x=$(()=>!q(),[]);S(()=>{!n||!a||!s||(r(!0),z({topicId:n,resourceId:a,resourceType:s}).then(w=>{r(!1),h(w)}).catch(console.error))},[n,a,s]),N("d",()=>{if(t==="done"){o();return}p("done")},[t]),N("l",()=>{if(t==="learning"){o();return}p("learning")},[t]),N("s",()=>{if(t==="skipped"){o();return}p("skipped")},[t]),N("r",()=>{if(console.log(t),t==="pending"){o();return}p("pending")},[t]);const p=w=>{if(x){o(),u();return}r(!0),H({topicId:n,resourceId:a,resourceType:s},w).then(()=>{h(w),o(),U(n,w)}).catch(C=>{alert(C.message),console.error(C)}).finally(()=>{r(!1)})},T=["pending","learning","done"].includes(t),v=["skipped","pending","learning"].includes(t),f=["done","skipped","pending"].includes(t),P=["skipped","done","learning"].includes(t);return b?e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:A}),e("span",{className:"ml-2",children:"Updating Status.."})]}):e("div",{className:"relative inline-flex rounded-md border border-gray-300",children:[e("span",{className:"inline-flex cursor-default items-center  p-1 px-2 text-sm text-black",children:[e("span",{class:"flex h-2 w-2",children:e("span",{class:`relative inline-flex h-2 w-2 rounded-full ${L[t]}`})}),e("span",{className:"ml-2 capitalize",children:t==="learning"?"In Progress":t})]}),e("button",{className:"inline-flex cursor-pointer items-center rounded-br-md rounded-tr-md border-l border-l-gray-300 bg-gray-100 p-1 px-2 text-sm text-black hover:bg-gray-200",onClick:()=>g(!0),children:[e("span",{className:"mr-0.5",children:"Update Status"}),e("img",{alt:"Check",class:"h-4 w-4",src:V})]}),i&&e("div",{className:"absolute right-0 top-full mt-1 flex min-w-[160px] flex-col divide-y rounded-md border border-gray-200 bg-white shadow-md [&>button:first-child]:rounded-t-md [&>button:last-child]:rounded-b-md",ref:c,children:[v&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>p("done"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${L.done}`}),"Done"]}),e("span",{class:"text-xs text-gray-500",children:"D"})]}),f&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>p("learning"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${L.learning}`}),"In Progress"]}),e("span",{class:"text-xs text-gray-500",children:"L"})]}),P&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>p("pending"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${L.pending}`}),"Reset"]}),e("span",{class:"text-xs text-gray-500",children:"R"})]}),T&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>p("skipped"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${L.skipped}`}),"Skip"]}),e("span",{class:"text-xs text-gray-500",children:"S"})]})]})]})}function Y(m){const{isLast:n,totalCount:a,onAdd:s,onRemove:o,onChange:u,id:b,title:r,link:t}=m,h=D(null),[i,g]=l(""),[c,x]=l(r),[p,T]=l(t);S(()=>{h?.current&&h.current.focus()},[]),S(()=>{u({id:b,title:c,link:p})},[c,p]);const v=n&&a<5;return e("div",{className:"relative mb-3 rounded-md border p-3",children:[e("p",{className:`mb-1 text-xs uppercase ${i==="title"?"text-black":"text-gray-400"}`,children:"Resource Title"}),e("input",{ref:h,type:"text",required:!0,className:"block w-full rounded-md border p-2 text-sm focus:border-gray-400 focus:outline-none",placeholder:"e.g. Introduction to RESTful APIs",onFocus:()=>g("title"),onBlur:()=>g(""),onChange:f=>x(f.target.value)}),e("p",{className:`mb-1 mt-3 text-xs uppercase ${i==="link"?"text-black":"text-gray-400"}`,children:"Resource Link"}),e("input",{type:"url",required:!0,className:"block w-full rounded-md border p-2 text-sm focus:border-gray-400 focus:outline-none",placeholder:"e.g. https://roadmap.sh/guides/some-url",onFocus:()=>g("link"),onBlur:()=>g(""),onChange:f=>T(f.target.value)}),e("div",{className:"mb-0 mt-3 flex gap-3",children:[a!==1&&e("button",{onClick:f=>{f.preventDefault(),o()},className:"rounded-md text-sm font-semibold text-red-500 underline underline-offset-2 hover:text-red-800",children:"- Remove Link"}),v&&e("button",{onClick:f=>{f.preventDefault(),s()},className:"rounded-md text-sm font-semibold text-gray-600 underline underline-offset-2 hover:text-black",children:"+ Add another Link"})]})]})}function Z(m){const{onClose:n,resourceType:a,resourceId:s,topicId:o}=m,[u,b]=l(!1),[r,t]=l([{id:new Date().getTime(),title:"",link:""}]);async function h(i){i.preventDefault(),b(!0);const{response:g,error:c}=await G("https://api.roadmap.sh/v1-contribute-link",{resourceType:a,resourceId:s,topicId:o,links:r});if(b(!1),!g||c){alert(c?.message||"Something went wrong. Please try again.");return}n("Thanks for your contribution! We will review it shortly.")}return e("div",{children:[e("div",{className:"mb-2 mt-2 rounded-md border bg-gray-100 p-3",children:[e("h1",{className:"mb-2 text-2xl font-bold",children:"Guidelines"}),e("ul",{class:"flex flex-col gap-1 text-sm text-gray-700",children:[e("li",{children:"Content should only be in English."}),e("li",{children:"Do not add things you have not evaluated personally."}),e("li",{children:"It should strictly be relevant to the topic."}),e("li",{children:"It should not be paid or behind a signup."}),e("li",{children:"Quality over quantity. Smaller set of quality links is preferred."})]})]}),e("form",{onSubmit:h,children:[r.map((i,g)=>e(Y,{id:i.id,title:i.title,link:i.link,isLast:g===r.length-1,totalCount:r.length,onChange:c=>{t(r.map(x=>x.id===i.id?c:x))},onRemove:()=>{t(r.filter(c=>c.id!==i.id))},onAdd:()=>{t([...r,{id:new Date().getTime(),title:"",link:""}])}},i.id)),e("div",{className:"flex gap-2",children:[e("button",{disabled:u,type:"submit",className:"block w-full rounded-md bg-gray-800 p-2 text-sm text-white hover:bg-black disabled:cursor-not-allowed disabled:bg-gray-400",children:u?"Please wait ...":"Submit"}),e("button",{className:"block w-full rounded-md border border-red-500 p-2 text-sm text-red-600 hover:bg-red-600 hover:text-white",onClick:i=>{i.preventDefault(),n()},children:"Cancel"})]})]})]})}function ue(){const[m,n]=l(""),[a,s]=l(!1),[o,u]=l(!1),[b,r]=l(!1),[t,h]=l(""),[i,g]=l(""),c=$(()=>!q(),[]),x=D(null),[p,T]=l(""),[v,f]=l(""),[P,w]=l("roadmap"),C=()=>{const d=document.querySelector("#login-popup");if(!d)return;d.classList.remove("hidden"),d.classList.add("flex");const k=d.querySelector("[autofocus]");k&&k.focus()};return M(x,()=>{s(!1),r(!1)}),N("Escape",()=>{s(!1),r(!1)}),J(({topicId:d,resourceType:k,resourceId:I})=>{if(c){C();return}E.set("Updating"),O({topicId:d,resourceId:I,resourceType:k}).then(y=>H({topicId:d,resourceId:I,resourceType:k},y?"pending":"done")).then(({done:y=[]})=>{U(d,y.includes(d)?"done":"pending")}).catch(y=>{alert(y.message),console.error(y)}).finally(()=>{E.set("")})}),W(({topicId:d,resourceType:k,resourceId:I})=>{u(!0),s(!0),K.set(!0),n(""),T(d),w(k),f(I);const y=d.replaceAll(":","/"),F=k==="roadmap"?`/${I}/${y}`:`/best-practices/${I}/${y}`;_(F,{},{headers:{Accept:"text/html"}}).then(({response:R})=>{if(!R){h("Topic not found.");return}const j=new DOMParser().parseFromString(R,"text/html")?.getElementById("main-content")?.outerHTML||"";u(!1),g(j)}).catch(R=>{h("Something went wrong. Please try again later."),u(!1)})}),a?e("div",{children:[e("div",{ref:x,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[o&&e("div",{className:"flex w-full justify-center",children:e("img",{src:A,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!o&&b&&e(Z,{resourceType:P,resourceId:v,topicId:p,onClose:d=>{d&&n(d),r(!1)}}),!b&&!o&&!t&&e(Q,{children:[e("div",{className:"mb-2",children:[e(X,{topicId:p,resourceId:v,resourceType:P,onShowLoginPopup:C,onClose:()=>{s(!1),r(!1)}}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>{s(!1),r(!1)},children:e("img",{alt:"Close",class:"h-5 w-5",src:B})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:i}}),e("div",{className:"mt-8 flex-1 border-t",children:[e("p",{class:"mb-2 mt-2 text-sm leading-relaxed text-gray-400",children:["Help others learn by submitting links to learn more about this topic"," "]}),e("button",{onClick:()=>{if(c){s(!1),C();return}r(!0)},disabled:!!m,className:"block w-full rounded-md bg-gray-800 p-2 text-sm text-white transition-colors hover:bg-black hover:text-white disabled:bg-green-200 disabled:text-black",children:m||"Submit a Link"})]})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]}):null}export{ue as TopicDetail};
